<!-- GENERATED by AgentKit Forge v0.2.1 — DO NOT EDIT -->
<!-- Source: .agentkit/spec + .agentkit/overlays/__TEMPLATE__ -->
<!-- Regenerate: pnpm -C .agentkit agentkit:sync -->
# iac Rules

Standards for all Infrastructure as Code. Covers Terraform and Terragrunt conventions, resource naming, state management, and module design.

## Applies To

**/*.tf
**/*.tfvars
**/terragrunt.hcl
**/*.hcl
infra/**
terraform/**
terragrunt/**
modules/**

## Conventions

- **[iac-naming-convention]** All cloud resources must follow the naming convention org-env-project-resourcetype-region. Configure org and region in project.yaml (infrastructure.org, infrastructure.defaultRegion) or use Terraform variables — do not hardcode. Example placeholders: YOUR_ORG, YOUR_DEFAULT_REGION. Deviations require a comment explaining why. Use locals blocks to compose names from variables.

- **[iac-toolchain]** Use Terraform for resource definitions and Terragrunt for DRY configuration, remote state management, and environment orchestration. All environments must be managed through Terragrunt live configurations.

- **[iac-state-backend]** Terraform state must be stored remotely (Azure Storage / S3 / GCS) with locking enabled. Never commit .tfstate files. State backend configuration must be managed through Terragrunt to avoid duplication.

- **[iac-modules]** Reusable infrastructure must be extracted into versioned Terraform modules. Modules must have README.md, variables.tf, outputs.tf, and examples/. Pin module versions in consumers — never use unversioned source references.

- **[iac-tagging]** All taggable resources must include mandatory tags: environment, project, owner, and cost-center. Use a shared locals block or Terragrunt inputs to enforce consistent tagging across all resources.

- **[iac-plan-before-apply]** Always run 'terraform plan' (or 'terragrunt plan') and review the diff before applying. CI pipelines must include a plan stage with human approval gate before apply. Never use -auto-approve in production environments.

- **[iac-no-hardcoded-secrets]** Never hardcode secrets, connection strings, or credentials in .tf or .hcl files. Use Key Vault / Secrets Manager references, or pass secrets via environment variables in CI. Sensitive variables must be marked sensitive = true.

- **[iac-fmt]** All Terraform code must pass 'terraform fmt -check'
- **[iac-validate]** All Terraform configurations must pass 'terraform validate'
- **[iac-drift-detection]** Infrastructure drift must be detected and corrected. Do not manually modify resources managed by Terraform. If manual changes are necessary, import them into state immediately and update the configuration.

